<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Time To Event and Known-fate (Survival) Analyses • MDChelp</title>
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Time To Event and Known-fate (Survival) Analyses">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MDChelp</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.01</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Bootstrapping.html">Non-parametric Bootstrapping</a></li>
    <li><a class="dropdown-item" href="../articles/CCAMarked.html">Capture-Recapture: Closed Capture Abundance - Marked Individuals</a></li>
    <li><a class="dropdown-item" href="../articles/CROverview.html">Capture-Recapture: Overview</a></li>
    <li><a class="dropdown-item" href="../articles/Quick-Nimble-Demo.html">Quick Nimble Demo</a></li>
    <li><a class="dropdown-item" href="../articles/TTE-Advanced.html">Time To Event and Known-fate (Survival) Analyses</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tlyons253/MDChelp/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="TTE-Advanced_files/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="TTE-Advanced_files/tabwid-1.1.3/tabwid.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Time To Event and Known-fate (Survival) Analyses</h1>
                        <h4 data-toc-skip class="author">Tim Lyons</h4>
            
            <h4 data-toc-skip class="date">Last Updated 12/03/25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/tlyons253/MDChelp/blob/master/vignettes/TTE-Advanced.Rmd" class="external-link"><code>vignettes/TTE-Advanced.Rmd</code></a></small>
      <div class="d-none name"><code>TTE-Advanced.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Time-to-event analysis can be very broad and encompasses a variety of
methods. Most of us will probably encounter this type of data as a
survival analysis and I tend to use examples from that application, but
it is much more flexible than that. At it’s core time to event data are
any data that:</p>
<ul>
<li>Have a known or well-defined “origin” time, or start time when the
sample (individual) is at risk of the event of interest happening.</li>
<li>The quantity of interest is the time to an event occurs (how long
before X happens) and how covariates affect that time.</li>
<li>The event must be categorical, either a Bernoulli variable
(live/dead) or multinomial (live, dead from cause A, dead from cause B…)
and you must be able to determine an event happened, if an event
happened (i.e. known-fate).</li>
</ul>
<p>Ecologists typically encounter it as a survival analysis where the
event of interest is death, but it can be almost anything. In ecology,
it’s been used to model resources selection (First-passage-time<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Freitas, C., K. M. Kovacs, C. Lydersen, R. A. Ims. 2008.
A novel method for quantifying habitat selection and predicting habitat
use. 45: 1213-1220. &lt;a href="https://www.whoi.edu/cms/files/Freitas2008_JAE_57188.pdf" class="external-link uri"&gt;https://www.whoi.edu/cms/files/Freitas2008_JAE_57188.pdf&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>),
epidemiology and disease dynamics<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Heisey, D.M., D. O. Joly, and F. Messier. 2006. The
fitting of general force-of-infection models to wildlife disease
prevalence data. Ecology. 87: 2356-2365. &lt;a href="https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1890/0012-9658(2006)87%5B2356:TFOGFM%5D2.0.CO;2" class="external-link uri"&gt;https://esajournals.onlinelibrary.wiley.com/doi/abs/10.1890/0012-9658(2006)87[2356:TFOGFM]2.0.CO;2&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>, and breeding ecology. <a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Karniski, C., E. Krzyszcyk, and J. Mann. 2018.
Senescence impacts reproduction and maternal investment in bottlenose
dolphins. Proceedings of the Royal Society B. 285:20181123. &lt;a href="https://royalsocietypublishing.org/doi/full/10.1098/rspb.2018.1123" class="external-link uri"&gt;https://royalsocietypublishing.org/doi/full/10.1098/rspb.2018.1123&lt;/a&gt;&lt;/p&gt;'><sup>3</sup></a> It’s also at the core
of the space-to-event model of estimating animal density.<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Moeller, A. K., P. M. Lukacs, and J. S. Horne. 2018.
Three novel methods to estimate abundance of unmarked animals using
remote cameras. Ecosphere 9(8):e02331&lt;/p&gt;"><sup>4</sup></a> Importantly, the event
of interest doesn’t just need to be something that can only occur once
(like death), the TTE framework can accommodate recurring events.</p>
<p><img src="images/methods.png" class="r-plt" width="50%" style="float:right; padding:10px">
Still, we’ll focus on the application to survival analysis since it’s
the most common and we can use other methods that folks might be more
familiar with to provide context. With that being said, within survival
analysis, it might often feel like we’re talking in circles about why to
use one method over another if they all can functionally accomplish the
same thing (there is generally a GLM analog to most of these things).
<br></p>
<p>What links TTE models (in survival analysis) to GLMs using a logit or
probit link is, a TTE analysis models the time to an event occurring,
whereas GLMs model the “probability of” an event occurring. Time is
explicit in TTE, whereas other analyses, you <em>might</em> include it
as a covariate. I’d argue that a hazard model is more confusing to use,
unless you really do have a natural or logical “origin” time.</p>
</div>
<div class="section level2">
<h2 id="key-concepts">Key Concepts<a class="anchor" aria-label="anchor" href="#key-concepts"></a>
</h2>
<p>There are some key concepts that are important to understanding TTE
analyses and how it relates to other analyses.</p>
<div class="section level3">
<h3 id="censoring-and-truncation">Censoring and Truncation<a class="anchor" aria-label="anchor" href="#censoring-and-truncation"></a>
</h3>
<p>Censoring and truncation are common to survival analyses and you’ve
dealt with it whether you’ve used TTE analyses or a GLM (e.g. logistic
exposure).</p>
<div class="section level4">
<h4 id="interval-censoring">Interval Censoring<a class="anchor" aria-label="anchor" href="#interval-censoring"></a>
</h4>
<p>The most common method of censoring is interval censoring. This is
where you don’t know the exact event time, just that occurred sometime
during an interval during the observation. So unless you are checking
nests or your radio-marked individuals every day, you will have interval
censored data. If you are fitting a GLM with a logit link, you probably
dealt with interval censoring by using the logistic exposure link or
another technique (like a cloglog link + offset). If you are familiar
with Program MARK and have used the known-fate module there, the concept
of interval censoring might seem confusing (it is for me at least)
because, if you lose track of an individual, you code an interval as
‘00’ to indicate an individual was missing, and thus, censor that time
period. They refer to it as interval censoring, but it’s not the same
“interval censoring” as is mentioned in most other texts regarding TTE
or survival analyses. It’s more accurately called interval truncation
and DeCesare et.al (2015<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;DeCesare, N. J., M. Hebblewhite, P. M. Lukacs, D.
Hervieux. 2015. Evaluating Sources of censoring and truncation in
telemetry-based survival data. Journal of Wildlife Management. 80:
138-148. &lt;a href="https://wildlife.onlinelibrary.wiley.com/doi/full/10.1002/jwmg.991" class="external-link uri"&gt;https://wildlife.onlinelibrary.wiley.com/doi/full/10.1002/jwmg.991&lt;/a&gt;&lt;/p&gt;'><sup>5</sup></a>) give a good explanation. It’s an artifact
of Program MARK using a model that does not permit interval censoring.
They even tell you that you should use their nest-survival module if you
have interval censoring.</p>
<p>Compare that to TTE analysis or almost any other analysis we’ll use
where interval censoring is allowed. In this, you do not need to drop
these observations. If the animal is observed detected dead later on,
the interval censoring handles the uncertainty as to when mortality
occurred. If you observe them alive later you know they survived. If you
never encounter them dead or alive again, it’s just right censoring, and
you are relying on the assumption that censoring is not informative.
This also requires that the probability of detecting an individual
doesn’t depend on their fate-the probability of finding that individual
that went missing is the same, regardless if you are finding them dead
or alive.</p>
</div>
<div class="section level4">
<h4 id="right-censoring-and-informative-censoring">Right Censoring and informative censoring<a class="anchor" aria-label="anchor" href="#right-censoring-and-informative-censoring"></a>
</h4>
<p>If you lose track of an individual and never find them (alive or
dead) or they haven’t died yet when the study ends, this is
right-censoring. In the latter case, it’s called fixed censoring,
whereas the former, it’s assumed random. That is, dying doesn’t cause
you to loose track of an individual. If this censoring is informative
(radio transmitters fail because they are destroyed by
cars/people/predators) then your survival estimate will be biased. This
is true regardless if you analyze the data in a TTE framework or a
logistic regression framework. If it is random (or at least nearly) then
it doesn’t matter. If you do lose track of a lot of individuals without
knowing their fate, it’s recommended you don’t use an approach that
relies on accurately knowing it.</p>
<p><img src="images/pawnstars.jpg" class="r-plt" width="50%" style="display: block; margin: auto;"><br></p>
</div>
<div class="section level4">
<h4 id="left-censoring-and-truncation">Left Censoring and Truncation<a class="anchor" aria-label="anchor" href="#left-censoring-and-truncation"></a>
</h4>
<p>Left censoring doesn’t make sense in a survival analysis, it means
the event of interest occurred before that individual became part of the
study. This is nonsense is it’s death. Left censoring undoubtedly occurs
in our data sets, but there is nothing we can typically do,
statistically speaking, to account for it. What we typically have in our
data sets is truncation.
<img src="images/princessbride.jpg" class="r-plt" width="40%" style="float:right; padding:10px;"></p>
<p>Left-truncation applies to individuals not observed from their origin
time, We experience this all the time with wildlife data; individuals
have to survive long enough for us to capture them.</p>
<p>Truncation can be accommodated (in a TTE analysis or a GLM) if you
specify a time at capture in a logit model or an entry time (relative to
origin). This is where it gets hard for me to wrap my head around. The
whole issue of left trunction or censoring only really makes sense if
you really do have an “origin time”, otherwise we often just get taught
ways to avoid having to deal with this. Hazard models accommodate left
truncation by only considering the interval for when the individual was
first observed. In a GLM, we generally would treat it as “heterogeneity”
and deal with it by including an appropriate covariate, such as
age-at-capture, and then maybe including age as a time-varying
covariate.</p>
<p>Clearly this doesn’t correct for the fact we might not be observing
individuals in some age/stage classes. There really isn’t a statistical
approach to “fix” this-it’s a sampling issue. That’s why we generally
talk about survival estimates for specific age-classes or at stages.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a>
</h2>
<p>A quick reminder, all of these methods are used to derive a
“survival” estimate, even though you are not modeling survival directly
(e.g. TTE).</p>
<div class="section level3">
<h3 id="modeling-survival-vs-hazards">Modeling survival vs Hazards<a class="anchor" aria-label="anchor" href="#modeling-survival-vs-hazards"></a>
</h3>
<div class="section level4">
<h4 id="glm-approaches--logit-link">GLM approaches -Logit link<a class="anchor" aria-label="anchor" href="#glm-approaches--logit-link"></a>
</h4>
<p>When talking about survival or a time-to event analysis it’s helpful
to start talking about using a GLM to estimate survival (or mortality)
because it’s probably what most folks are familiar with. The first big
difference is that using a GLM, you’re modeling the probability of the
event occurring over some interval, not how long before it occurs. We
generally use this approach (as opposed to a TTE method), because we
really don’t have the ability to define an origin time, typically
because individuals are entering and leaving the study at varying time
points and/ or because we can’t accurately age individuals.</p>
<p>In this approach, your data is probably a table with, at minimum,
rows equal to the number of individuals <strong>x</strong> the number of
intervals and a column indicating if that individual survived or died
during that interval (e.g. 1/0). If your intervals are regular and equal
in length you can use generic, built-in methods for estimating survival
(e.g. logit link). If you are interested in modeling survival as a
function of time (age, day of year), you typically deal with it by using
a interval-specific covariate. Left truncation can be dealt with in this
way, interval truncation can be handled by omitting those intervals
where you were unable to verify the status of an individual (but might
not be necessary), and right censoring is handled implicitly by an
individual no longer appearing in the records.</p>
<p>If the checks are at irregular intervals, or you experience more than
a trivial amount of interval truncation, then you are better off
accounting for the variable length of time in each interval using the
logistic exposure method.</p>
</div>
<div class="section level4">
<h4 id="kaplan-meier">Kaplan-Meier<a class="anchor" aria-label="anchor" href="#kaplan-meier"></a>
</h4>
<p>Kaplan-Meier is called a non-parametric method because any of the
quantities you describe (cumulative survival, period survival) are
obtained by simple arithmetic where:</p>
<p><span class="math display">\[ S_t=\frac{N_{alive\ at\ t}}{N_{alive\
t-1}}\]</span></p>
<p>You’re not using a linear model to estimate parameters. If you only
use discrete covariates, then a logit model as described above is
equivalent to a Kaplan-Meier estimate. However, a logit model gives you
more flexibility, namely in the types of covariates you can include.
Furthermore, Kaplan-Meier estimates assume there is no interval
censoring. It’s generally your best bet if you don’t have very many
individuals in your data set.</p>
<p>Plots of Kaplan-Meier estimates typically show
<u><em>cumulative</em></u> survival probability as a function of time in
a stair-step pattern. Note that this is not implying that survival
probability varies with time. Kaplan-Meier estimates survival at each
time step, but it is visualized as the proportion of individuals
remaining at time T, which is equivalent to <span class="math inline">\(S^T\)</span>, where <span class="math inline">\(S\)</span> is the 1-unit survival probability.</p>
<p><img src="TTE-Advanced_files/figure-html/unnamed-chunk-4-1.png" class="r-plt" width="80%"></p>
<p>You can see that the GLM- constant survival estimates the cumulative
survival probability as being lower than observed in the data, until the
end, which is what the KM estimate shows. Nevertheless, they all produce
the same average daily survival rate. The GLM that allowed time-varying
survival is a better approximation of the KM curve, but also may just be
overfitting, as the data for the plot were simulated using a constant
survival probability.</p>
</div>
<div class="section level4">
<h4 id="log-log-link">Log-Log link<a class="anchor" aria-label="anchor" href="#log-log-link"></a>
</h4>
<p>An alternative to using logit-link regression is to use a log-log
link or:</p>
<p><span class="math display">\[ S=exp(-exp(X\beta))\\ and\ the\
inverse\\ X\beta=log(-log(S))\]</span></p>
<p>where <span class="math inline">\(S\)</span> is the survival
probability and <span class="math inline">\(X\beta\)</span> is the
linear predictor. This approach gives the same interpretation (hazard
ratios) of the <span class="math inline">\(\beta_k\)</span> regression
coefficients as in proportional hazard models. Often this is preferable
to using the logit link because hazards ratios (the relative difference
in mortality) don’t change whether your model is talking about weekly,
monthly, or annual survival. Odds ratios will differ, which may be just
confusing or worse, misleading. In R, you have to use the complementary
log-log link, which is equivalent to replaceing <span class="math inline">\(S\)</span> with <span class="math inline">\(M\)</span>, as that is what <span class="math inline">\(X\beta\)</span> predicts. In R, you still code
your data as 1=alive, 0=dead, but you are essentially modeling the 0’s
when using that data structure and the cloglog link.</p>
<p>Interval censoring can be accommodated when using the logit-link by
using the logistic-exposure link, and including an offset for the number
of exposure days in each interval when using the cloglog link.</p>
</div>
</div>
<div class="section level3">
<h3 id="modeling-time-to-event">Modeling time-to-event<a class="anchor" aria-label="anchor" href="#modeling-time-to-event"></a>
</h3>
<p>As the name implies, you’re not estimating the probability an event
occurs at a specific interval (like in a GLM), but instead the amount of
time it takes for an event to happen. It gets discussed as modeling a
process in continuous time (TTE) vs. discrete time. Thus, instead of
calculating the probability an event occurs in an interval, the TTE is
estimating the number of events/deaths a “immortal individual” might
experience over some time frame. Coming from a background modeling nest
survival in discrete time, the big mental flip for me in wrapping my
head around this has been stopping thinking about my analyses like
graphs of DSR and instead, thinking about graphs that show cumulative
survival. It’s that curve, called a survivor function that TTE is
estimating. The derivative of that curve at any time point is <span class="math inline">\(h(t)\)</span> or the hazard function.</p>
<p>The math to develop the survivor function is fundamentally different
then using something like logstic (exposure) regression. When using the
logit link, you can develop the equivalent information by computing the
product of the logit-transformed linear predictors</p>
<p><span class="math display">\[Discrete\ time ,\ logit\ link\\
S_{n|1}=\prod_{t=1}^{N}S_t=S_1\cdot S_2\cdot S_3...S_n\\
S_t=\frac{exp(X\beta)}{1+exp(X\beta)}\]</span></p>
<p>and what it looks like if we used a proportional hazards model</p>
<p><span class="math display">\[TTE\ or\ Continuous\ Time-Proportional
Hazards\\
S_{1|n}=exp(-\sum_{t=1}^{N}{exp(X\beta)})\]</span></p>
<p>It doesn’t look like much different, but it makes some math things
easier. Particularly, as mentioned before, comparing the effect of a
covariate on the outcome at a different unit than what you initially
measured <span class="math inline">\(t\)</span> on. It also becomes
easier to model a wider of nonlinear effects time or age on survival
than is typically available in a GLM (e.g. linear, quadratic, cubic…).
The figure to the right demonstrates that. It comes from a TTE workshop
at the TWS meeting in Reno in 2019, though the data are on a long-term
deer survival study in northern MN.</p>
<p><img src="images/hazard_surv.jpg" class="r-plt" width="100%"></p>
<p><br> The textbook definition of the hazard is the instantaneous rate
of mortality. If the hazard is high, mortality is high and vice versa.
TTE focuses on estimating the timing of events regardless of actual
procedure.</p>
<p>The simplest form of a TTE linear model is <span class="math display">\[h(t) = \lambda_0 \cdot \lambda_t\]</span> This is
the hazard at time <span class="math inline">\(t\)</span>, is the
product of some baseline hazard<span class="math inline">\(\lambda_0\)</span>, and covariates <span class="math inline">\(\lambda_t\)</span> that can be modeled using a log
link.</p>
<p><span class="math display">\[\lambda_t=exp(\beta_1X_1+\beta_2X_2...\beta_kX_k)\]</span></p>
<p>This particular formulation is a proportional hazards (PH) model.
Proportional hazards models can be semi-parametric, where you don’t try
to specify a distribution of the baseline hazard, or fully parametric
where you do.</p>
<p>The distribution used to specify the baseline hazard can have a
dramatic effect on the shape of the hazard curve and whether your model
is still a proportional hazards model, or if it now becomes an
accelerated-failure-time (AFT) model, or something else.</p>
<div class="section level4">
<h4 id="semi-parametric">Semi parametric<a class="anchor" aria-label="anchor" href="#semi-parametric"></a>
</h4>
<p>The semi-parametric hazard model is synonymous with Cox’s
proportional hazard. It is not, however, the only version of a
proportional hazard model. Cox gets his name attached because he came up
with a slick way to estimate the regression coefficients of <span class="math inline">\(\lambda_t\)</span> without ever having to estimate
<span class="math inline">\(\lambda_0\)</span>, using a partial
likelihood. People don’t really like trying to have to specify that
baseline so it’s often preferable to use this approach. However, a true
Cox’s proportional hazard model doesn’t work with interval censoring, so
most applications will probably use a parametric hazards model. For
example, if you have interval censoring and want to use a proportional
hazard model, you will actually fit a parametric hazard model, using an
exponential baseline hazard.</p>
<p>Important to note, like the cloglog link, you are modeling mortality,
so negative coefficients (log-hazard ratios) mean a negative association
with <strong>mortality</strong>. It’s also worth noting that without
specifying some kind of distribution for the baseline hazard, you can
only get a survivor curve by estimating the baseline with non-parametric
methods. This is hard, and using a parametric, exponential model is the
equivalent. So it’s more straightforward to just do that!</p>
</div>
<div class="section level4">
<h4 id="parametric-hazards">Parametric Hazards<a class="anchor" aria-label="anchor" href="#parametric-hazards"></a>
</h4>
<p>Parametric hazards have you specify a distribution of the baseline
hazard. Proportional hazards (PH), proportional odds (PO), and
accelerated-failure-time (AFT) models are types all parametric TTE
models. The difference in these models is:</p>
<ul>
<li>the link used to model the hazard</li>
<li>whether the hazard changes through time.</li>
</ul>
<p>Another way to see some of these connections is to re-write the time
to event model as a linear function of the times of the event, not the
hazard:</p>
<p><span class="math display">\[log(T)=\beta_0+\beta_1X_1+\beta_2X_2...+\sigma\epsilon\]</span></p>
<p>where an random disturbance term <span class="math inline">\(\epsilon\)</span> follows some distribution. Most
software routines don’t estimate the variance of <span class="math inline">\(\epsilon\)</span> but hold it constant and
estimate <span class="math inline">\(\sigma\)</span> as a scaling
parameter instead. As is described in the Paul Allison SAS survival
book, depending on the distribution you assume for <span class="math inline">\(\epsilon\)</span>, there is a corresponding hazard
function:</p>
<ol style="list-style-type: decimal">
<li>if <span class="math inline">\(\epsilon\)</span> is extreme-value
(exponential distribution) and <span class="math inline">\(\sigma\)</span> is fixed at one then T is
exponentially distributed and gives a hazard function:</li>
</ol>
<p><span class="math display">\[log(h(t))=\beta_0^*+\beta_1^*X_1...\beta_k^*X_k\]</span></p>
<p>This is the functionally the same hazard model used in Cox’s PH but
now with an intercept. This is an exponential model, or a constant
hazard because nothing in here specifically models the hazard as a
function of time. If we did have a term here that was a function of
time, it would be an AFT model.</p>
<ol start="2" style="list-style-type: decimal">
<li>if <span class="math inline">\(\epsilon\)</span> is extreme-value
(exponential distribution) but <span class="math inline">\(\sigma\)</span> isn’t fixed at 1, then T follows a
Weibull distribution and, per the SAS survival book:</li>
</ol>
<p><span class="math display">\[log(h(t))=\alpha\log(t)+\beta_0^*+\beta_1^*X_1...\beta_k^*X_k\]</span></p>
<p>This is now an AFT, depending on the parameter value of <span class="math inline">\(\alpha\)</span>(see pp. 20-21 in SAS survival
book). In this case, <span class="math inline">\(\alpha\)</span>
controls how the hazard varies across time, ensuring that the event
times T follow a Weibull distribution. If <span class="math inline">\(\alpha\)</span> is just 0, then the hazard is
constant through time and we’re back at the exponential
distribution.</p>
<p>Fun fact, the Weibull above is both and AFT and a PH model, and it’s
the only form that can both. That’s because, in the equation above, you
could think of the <span class="math inline">\(\alpha\log(t)\)</span> as
a baseline hazard</p>
<p>Another way to write the Weibull hazard can be found in handout 9 <a href="%22https://stat.ethz.ch/education/semesters/ss2011/seminar/contents/handout_9.pdf%22" class="external-link">here</a>
is as:</p>
<p><span class="math display">\[h(t)=\lambda p t^{p-1}\\
log(h(t))=log(\lambda)+log(p)+(p-1)log(t)\\
log(h(t))=\alpha\ log(t)
+\beta_0^*+\beta_1^*X_1...\beta_k^*X_k\]</span></p>
<p>where <span class="math inline">\(p\)</span> is <span class="math inline">\(\frac{1}{\sigma}\)</span> from the <span class="math inline">\(log(T)\)</span> equation above. So it looks like
the difference between the two resources is <span class="math inline">\(\alpha \sim p-1\)</span> and the value of log(p)
seems to end up in the <span class="math inline">\(\beta_0\)</span>?</p>
<p>Other forms include the Log logistic</p>
<p><span class="math display">\[h(t)=\frac{\lambda p t^{p-1}}{1+\lambda
t^p}\]</span> which gives a proportional odds model. All of these are
AFT models</p>
<p>Typically, however, when you are fitting an AFT model you’re not
writing a linear model for the hazard, your linear model is for <span class="math inline">\(log(T)\)</span> and you coefficients will be
expressed as their effect on survival time, not the hazard.</p>
</div>
<div class="section level4">
<h4 id="what-makes-a-model-an-aft-andor-ph">What makes a model an AFT and/or PH?<a class="anchor" aria-label="anchor" href="#what-makes-a-model-an-aft-andor-ph"></a>
</h4>
<p>These graphs from <a href="https://cran.r-project.org/web/packages/eha/vignettes/parametric.html" class="external-link">here</a>
help visually demonstrate it, as does the lecture notes found <a href="https://myweb.uiowa.edu/pbreheny/7210/f19/notes/10-15.pdf" class="external-link">here</a>.
The PH has proportional hazards, but not a constant hazard rate. In
short a proportional hazards model assumes that the hazard ratio doesn’t
change as time changes. A graph of the hazard of two groups over time
would be parallel, with the peak in the hazard occurring at the same
time. In the AFT, the hazard peaks earlier or later for one group. So
it’s a difference of up/down vs. left/right. This is what is meant when
books/slides say an AFT “stretches” time in an AFT. <br><img src="images/AFTvPH.jpg" class="r-plt" width="100%"></p>
<p><br> The other big difference is that when you fit an AFT model, you
will code it up (or an existing package) where you put your linear model
on survival time, not the hazard. This is because anything other than an
exponential distribution gets really messy looking on the hazard scale.
You can still derive it, but it’s more straight forward to write the
linear model for <span class="math inline">\(T\)</span>, not <span class="math inline">\(h(t)\)</span></p>
<p><strong>Some</strong> AFT models are also PH models (e.g. Weibull),
but most aren’t. They don’t need to be. The whole value of AFT models
are for when you do not meet the proportional hazards assumption
(i.e. the hazard ratio changes through time). Still in an AFT, you need
to specify a baseline distribution for T.</p>
<ul>
<li>You typically won’t use an AFT with left truncation-why? You need
those data to help fit the curve/ determine the appropriate shape of the
baseline hazard. But if you want to be risky and specify one anyway,
hope you’re right, you can “predict” outside of your sample the survival
times of those individuals you never observed.</li>
</ul>
<p>Because it’s hard to know what distribution to use for that baseline
hazard (i.e. how does the hazard vary with time) it’s usually easier to
turn an exponential PH model (which is not technically an AFT, as it has
a constant baseline hazard) and throw in tricks to account for temporal
variation or non-constant hazard ratios (see the slides from Reno). This
approach works and is probably what you will end up doing most of the
time, but as it gets more complicated (e.g. time-varying coefficients,
piecewise exponential model), I think it feels a little too “Dr. Moreau”
(<a href="https://en.wikipedia.org/wiki/The_Island_of_Dr._Moreau_(1996_film)" class="external-link">clearly,
Brando’s best film ever</a>)</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-nest-survival">Example: nest survival<a class="anchor" aria-label="anchor" href="#example-nest-survival"></a>
</h2>
<p>This shows how time-varying survival might be incorporated in a
hazards model or in a GLM framework. This approach assumes you know the
age of the nest at discovery, but not all nests are discovered on the
first day. It also assumes you check any active nests on the 25th day,
the day the nesting attempt ought to be complete. Again, the TTE model
doesn’t make sense unless there is a logical origin time.</p>
<div class="section level3">
<h3 id="constant-survival">Constant survival<a class="anchor" aria-label="anchor" href="#constant-survival"></a>
</h3>
<p>Simulate data with a mean DSR of 0.985 and a nesting period of 25
days</p>
<p>This is what the TTE data look like from one realization of the
simulated data. Left is the date a nest was discovered, right is the
last day it was monitored, and censor refers to if the nest survived
that interval. Note how nests that failed at some point have two rows,
one representing the interval of time that the nest was known to be
alive, and another for the interval that the nest failed. This data is
formatted for use in a nimble model specified below.</p>
<div class="tabwid">
<style>.cl-86509f48{}.cl-86483f4c{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-86483f56{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-864af6c4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-864b1640{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b164a{width:0.581in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b164b{width:0.704in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1654{width:0.859in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1655{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b165e{width:0.581in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b165f{width:0.704in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1660{width:0.859in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1668{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1669{width:0.581in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b166a{width:0.704in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1672{width:0.859in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1673{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1674{width:0.581in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b1675{width:0.704in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-864b167c{width:0.859in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8643520c{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8643523e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style>
<table data-quarto-disable-processing="true" class="table cl-86509f48">
<caption style="display:table-caption;margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;">
<span class="cl-8643520c">Table 1.</span><span class="cl-8643523e"> Time to event data format</span>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-864b1640"><p class="cl-864af6c4"><span class="cl-86483f4c">nest.id</span></p></th>
<th class="cl-864b164a"><p class="cl-864af6c4"><span class="cl-86483f4c">left</span></p></th>
<th class="cl-864b164b"><p class="cl-864af6c4"><span class="cl-86483f4c">right</span></p></th>
<th class="cl-864b1654"><p class="cl-864af6c4"><span class="cl-86483f4c">censor</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1655"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b165e"><p class="cl-864af6c4"><span class="cl-86483f56">2</span></p></td>
<td class="cl-864b165f"><p class="cl-864af6c4"><span class="cl-86483f56">13</span></p></td>
<td class="cl-864b1660"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">13</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">14</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">2</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">3</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">4</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">5</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">8</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">6</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">7</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">3</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">16</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">7</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">16</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">18</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">8</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">9</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">16</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">9</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">16</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">17</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">10</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1668"><p class="cl-864af6c4"><span class="cl-86483f56">11</span></p></td>
<td class="cl-864b1669"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
<td class="cl-864b166a"><p class="cl-864af6c4"><span class="cl-86483f56">3</span></p></td>
<td class="cl-864b1672"><p class="cl-864af6c4"><span class="cl-86483f56">0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-864b1673"><p class="cl-864af6c4"><span class="cl-86483f56">12</span></p></td>
<td class="cl-864b1674"><p class="cl-864af6c4"><span class="cl-86483f56">3</span></p></td>
<td class="cl-864b1675"><p class="cl-864af6c4"><span class="cl-86483f56">25</span></p></td>
<td class="cl-864b167c"><p class="cl-864af6c4"><span class="cl-86483f56">1</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>The <strong>Survive”</strong> package in R which would otherwise fit
a Cox proportional hazards model does not handle interval censoring so
we can’t use it here. There are ways to specify interval censoring and
right censoring using the <strong>survreg</strong> function in the
<strong>“survival”</strong> package which fits parametric models, but if
you specify an exponential distribution, it’s equivalent to a
proportional hazards model. It, however, assumes you have been
monitoring all individuals from the time origin (i.e., no left
truncation) <br> And here is what the GLM Data looks like</p>
<div class="tabwid">
<style>.cl-868a7bb4{}.cl-8682dcb0{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8682dcba{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8685fc56{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-86861f10{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f11{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f1a{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f1b{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f1c{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f24{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f25{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f2e{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f2f{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f30{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f31{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f38{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f39{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f3a{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f42{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f43{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f4c{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f4d{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f56{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f57{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f60{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861f61{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861fa6{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861fb0{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861fb1{width:0.881in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861fb2{width:0.597in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861fba{width:1.08in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86861fbb{width:0.81in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-867dc572{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-867dc57c{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style>
<table data-quarto-disable-processing="true" class="table cl-868a7bb4">
<caption style="display:table-caption;margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;">
<span class="cl-867dc572">Table 2.</span><span class="cl-867dc57c"> A subset of GLM survival data</span>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-86861f10"><p class="cl-8685fc56"><span class="cl-8682dcb0">nest.id</span></p></th>
<th class="cl-86861f11"><p class="cl-8685fc56"><span class="cl-8682dcb0">day</span></p></th>
<th class="cl-86861f1a"><p class="cl-8685fc56"><span class="cl-8682dcb0">exposure</span></p></th>
<th class="cl-86861f1b"><p class="cl-8685fc56"><span class="cl-8682dcb0">obs.ld</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f1c"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f24"><p class="cl-8685fc56"><span class="cl-8682dcba">6</span></p></td>
<td class="cl-86861f25"><p class="cl-8685fc56"><span class="cl-8682dcba">4</span></p></td>
<td class="cl-86861f2e"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f2f"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f30"><p class="cl-8685fc56"><span class="cl-8682dcba">7</span></p></td>
<td class="cl-86861f31"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f38"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">8</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">9</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">10</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f2f"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f30"><p class="cl-8685fc56"><span class="cl-8682dcba">11</span></p></td>
<td class="cl-86861f31"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f38"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">13</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">14</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">0</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f4c"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f4d"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f56"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f57"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">3</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f4c"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f4d"><p class="cl-8685fc56"><span class="cl-8682dcba">4</span></p></td>
<td class="cl-86861f56"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861f57"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f60"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f61"><p class="cl-8685fc56"><span class="cl-8682dcba">5</span></p></td>
<td class="cl-86861fa6"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861fb0"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f4c"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f4d"><p class="cl-8685fc56"><span class="cl-8682dcba">7</span></p></td>
<td class="cl-86861f56"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f57"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861f39"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f3a"><p class="cl-8685fc56"><span class="cl-8682dcba">9</span></p></td>
<td class="cl-86861f42"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861f43"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-86861fb1"><p class="cl-8685fc56"><span class="cl-8682dcba">2</span></p></td>
<td class="cl-86861fb2"><p class="cl-8685fc56"><span class="cl-8682dcba">10</span></p></td>
<td class="cl-86861fba"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
<td class="cl-86861fbb"><p class="cl-8685fc56"><span class="cl-8682dcba">1</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="section level4">
<h4 id="analysis-using-a-tte-hazards-model">Analysis using a TTE hazards model<a class="anchor" aria-label="anchor" href="#analysis-using-a-tte-hazards-model"></a>
</h4>
<p>The model below a parametric model with an exponential distribution
If you use a simple exponential function, your baseline hazard is
constant and it will generally produce the same hazard ratios as a Cox
PH model that doesn’t assume a baseline hazard.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-nimble.org" class="external-link">nimble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">constant.model</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html" class="external-link">nimbleCode</a></span><span class="op">(</span><span class="op">{</span></span>
<span> <span class="va">gamma0</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/flat.html" class="external-link">dflat</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">records</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">left</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">:</span><span class="op">(</span><span class="va">right</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">UCH</span><span class="op">[</span><span class="va">j</span>,<span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">gamma0</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">S</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">UCH</span><span class="op">[</span><span class="va">j</span>,<span class="va">left</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">:</span><span class="op">(</span><span class="va">right</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">censored</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dbern</span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">)</span> <span class="op">{</span> <span class="co">#compute the survival function S0</span></span>
<span>    <span class="va">UCH0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">gamma0</span><span class="op">)</span></span>
<span>    <span class="va">CH0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">UCH0</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co">#sum the unit cumulative hazard to get the cumulative</span></span>
<span>                 <span class="co">#hazard (i.e prob of surviving day 1 to i, or S^2,S^3..S^i</span></span>
<span>    <span class="va">S0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">CH0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># transform to survival estimate to time i</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">#define data and constants</span></span>
<span></span>
<span><span class="va">nim.const</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>records<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tte.dat</span><span class="op">)</span>,</span>
<span>                left<span class="op">=</span><span class="va">tte.dat</span><span class="op">$</span><span class="va">left</span>,</span>
<span>                right<span class="op">=</span><span class="va">tte.dat</span><span class="op">$</span><span class="va">right</span><span class="op">)</span></span>
<span><span class="va">nim.dat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>censored<span class="op">=</span><span class="va">tte.dat</span><span class="op">$</span><span class="va">censor</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#inits</span></span>
<span></span>
<span><span class="va">nim.init</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  gamma0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">constant.nimmod</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimbleModel.html" class="external-link">nimbleModel</a></span><span class="op">(</span>code<span class="op">=</span><span class="va">constant.model</span>,</span>
<span>                               constants<span class="op">=</span><span class="va">nim.const</span>,</span>
<span>                               data<span class="op">=</span><span class="va">nim.dat</span>,</span>
<span>                               inits<span class="op">=</span><span class="fu">nim.init</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">constant.nimmod</span><span class="op">$</span><span class="fu">calculate</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Check to make sure initial values are good.</span></span>
<span>                              <span class="co">#Should be a real number</span></span>
<span></span>
<span></span>
<span><span class="va">constant.config</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/configureMCMC.html" class="external-link">configureMCMC</a></span><span class="op">(</span><span class="va">constant.nimmod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now is when you can specify different samplers and monitors</span></span>
<span><span class="va">constant.config</span><span class="op">$</span><span class="fu">addMonitors</span><span class="op">(</span><span class="st">"CH0"</span>,<span class="st">"UCH0"</span>,<span class="st">"S0"</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">constant.build</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/buildMCMC.html" class="external-link">buildMCMC</a></span><span class="op">(</span><span class="va">constant.config</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#compile things</span></span>
<span></span>
<span><span class="va">constant.comp</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/compileNimble.html" class="external-link">compileNimble</a></span><span class="op">(</span><span class="va">constant.nimmod</span><span class="op">)</span></span>
<span></span>
<span><span class="va">constant.mcmc</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/compileNimble.html" class="external-link">compileNimble</a></span><span class="op">(</span><span class="va">constant.build</span>, project<span class="op">=</span><span class="va">constant.comp</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">samples.constant</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/runMCMC.html" class="external-link">runMCMC</a></span><span class="op">(</span><span class="va">constant.mcmc</span>,</span>
<span>                             niter<span class="op">=</span><span class="fl">5000</span>,</span>
<span>                             nburnin <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>                             nchains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##             mean        sd     2.5%       50%     97.5% Rhat n.eff</span></span>
<span><span class="co">## gamma0 -4.153043 0.2928866 -4.76659 -4.136809 -3.627007    1  2676</span></span></code></pre>
<p><img src="TTE-Advanced_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" width="700"><br></p>
<p>The gamma parameter needs to be transformed back to survival. To do
so, just exponentiate the value on the linear scale (in this case, just
gamma, but it could include other terms). But this isn’t the surival
probability, it’s the mortality probability. So the true transformation
is:</p>
<p><span class="math display">\[S=1-exp(\gamma_0)\\
or\\
S=1-exp(\gamma_0+\gamma_1X_1+\gamma_2X_2...)\]</span></p>
<p>if there are covariates, where all the <span class="math inline">\(\gamma_k\)</span> are log hazard ratios (the
equivalent of a <span class="math inline">\(\beta\)</span> in a
GLM).</p>
<p>This means the estimated daily survival from the TTE model is
0.984.</p>
</div>
<div class="section level4">
<h4 id="analysis-using-logistic-exposure">Analysis using logistic exposure<a class="anchor" aria-label="anchor" href="#analysis-using-logistic-exposure"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#####   Create the link function</span></span>
<span><span class="co"># Link function comes from Ben Bolker's page: https://rpubs.com/bbolker/logregexp</span></span>
<span></span>
<span><span class="va">logexp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">exposure</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## hack to help with visualization, post-prediction etc etc</span></span>
<span>  <span class="va">get_exposure</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"..exposure"</span>, env<span class="op">=</span><span class="va">.GlobalEnv</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"..exposure"</span>, envir<span class="op">=</span><span class="va">.GlobalEnv</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">exposure</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">linkfun</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">mu</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="va">mu</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fu">get_exposure</span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="co">## FIXME: is there some trick we can play here to allow</span></span>
<span>  <span class="co">##   evaluation in the context of the 'data' argument?</span></span>
<span>  <span class="va">linkinv</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">^</span><span class="fu">get_exposure</span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">logit_mu_eta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">30</span>,<span class="va">.Machine</span><span class="op">$</span><span class="va">double.eps</span>,</span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">mu.eta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">get_exposure</span><span class="op">(</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">eta</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fu">get_exposure</span><span class="op">(</span><span class="op">)</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="op">*</span></span>
<span>      <span class="fu">logit_mu_eta</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">valideta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">eta</span><span class="op">)</span> <span class="cn">TRUE</span></span>
<span>  <span class="va">link</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"logexp("</span>, <span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/substitute.html" class="external-link">substitute</a></span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span>, <span class="st">")"</span>,</span>
<span>                sep<span class="op">=</span><span class="st">""</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/structure.html" class="external-link">structure</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>linkfun <span class="op">=</span> <span class="va">linkfun</span>, linkinv <span class="op">=</span> <span class="va">linkinv</span>,</span>
<span>                 mu.eta <span class="op">=</span> <span class="va">mu.eta</span>, valideta <span class="op">=</span> <span class="va">valideta</span>,</span>
<span>                 name <span class="op">=</span> <span class="va">link</span><span class="op">)</span>,</span>
<span>            class <span class="op">=</span> <span class="st">"link-glm"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>This link function needs to be in your GlobalEnvironment.
Alternatively, it’s included as a function in the MDChelp package using
‘MDChelp::logexp()’</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###########</span></span>
<span></span>
<span></span>
<span><span class="va">mod.logexp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">obs.ld</span><span class="op">~</span><span class="fl">1</span>,family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="fu">MDChelp</span><span class="fu">::</span><span class="fu"><a href="../reference/logexp.html">logexp</a></span><span class="op">(</span><span class="va">glm.dat</span><span class="op">$</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                data<span class="op">=</span><span class="va">glm.dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">mod.logexp</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">parms.logit</span></span>
<span></span>
<span><span class="va">parms.logit</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)     4.02     0.280      14.4 1.00<span style="color: #949494;">e</span><span style="color: #BB0000;">-46</span></span></span></code></pre>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#DSR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">parms.logit</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">dsr.logit</span></span>
<span></span>
<span><span class="va">dsr.logit</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.9824191</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="analysis-using-the-cloglog-link-and-exposure-time-as-an-offset-">Analysis using the cloglog link and exposure time as an offset.<a class="anchor" aria-label="anchor" href="#analysis-using-the-cloglog-link-and-exposure-time-as-an-offset-"></a>
</h4>
<p>When back-transforming, we need the mean mean of the “exposure”
variable.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mod.clog</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">obs.ld</span><span class="op">~</span><span class="fl">1</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/stats/offset.html" class="external-link">offset</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span>,</span>
<span>              family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'cloglog'</span><span class="op">)</span>,</span>
<span>              data<span class="op">=</span><span class="va">glm.dat</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">mod.clog</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">parms.clog</span></span>
<span></span>
<span><span class="va">parms.clog</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 1 × 5</span></span></span>
<span><span class="co">##   term        estimate std.error statistic  p.value</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> (Intercept)    0.975    0.074<span style="text-decoration: underline;">5</span>      13.1 4.36<span style="color: #949494;">e</span><span style="color: #BB0000;">-39</span></span></span></code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#calculate mean exposure</span></span>
<span><span class="va">mu.exp</span><span class="op">&lt;-</span><span class="va">glm.dat</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">parms.clog</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">+</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">mu.exp</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>lp<span class="op">=</span><span class="fl">1</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>dsr<span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lp</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">dsr</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">dsr.clog</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">dsr.clog</span>,digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 0.984</span></span></code></pre>
<p>Now compare among the methods</p>
<p>See how they are all very similar to one another and less than 0.005
different than the data-generating value of 0.985? See how it only has a
small effect on the cumulative survival probability <span class="math inline">\((DSR^{24})\)</span> (24 survival periods to
survive 25 days), which could just be sampling error. Very mindful, very
demure.</p>
<div class="tabwid">
<style>.cl-8709484a{}.cl-8702d852{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8702d85c{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-87054344{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-87055e56{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055e7e{width:0.893in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055e92{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055e93{width:1.81in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055e9c{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ea6{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ea7{width:0.893in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ea8{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055eb0{width:1.81in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055eb1{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055eba{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ebb{width:0.893in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ec4{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ec5{width:1.81in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-87055ece{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-86ff87f6{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-86ff8800{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style>
<table data-quarto-disable-processing="true" class="table cl-8709484a">
<caption style="display:table-caption;margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;">
<span class="cl-86ff87f6">Table 3.</span><span class="cl-86ff8800"> Survival estimate comparison among methods</span>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-87055e56"><p class="cl-87054344"><span class="cl-8702d852">Parameter</span></p></th>
<th class="cl-87055e7e"><p class="cl-87054344"><span class="cl-8702d852">Hazard</span></p></th>
<th class="cl-87055e92"><p class="cl-87054344"><span class="cl-8702d852">Logistic exposure</span></p></th>
<th class="cl-87055e93"><p class="cl-87054344"><span class="cl-8702d852">Cloglog + offset()</span></p></th>
<th class="cl-87055e9c"><p class="cl-87054344"><span class="cl-8702d852">"Truth"</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-87055ea6"><p class="cl-87054344"><span class="cl-8702d85c">DSR</span></p></td>
<td class="cl-87055ea7"><p class="cl-87054344"><span class="cl-8702d85c">0.984</span></p></td>
<td class="cl-87055ea8"><p class="cl-87054344"><span class="cl-8702d85c">0.982</span></p></td>
<td class="cl-87055eb0"><p class="cl-87054344"><span class="cl-8702d85c">0.984</span></p></td>
<td class="cl-87055eb1"><p class="cl-87054344"><span class="cl-8702d85c">0.985</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-87055eba"><p class="cl-87054344"><span class="cl-8702d85c">Cumulative survival</span><br><span class="cl-8702d85c">(25d)</span></p></td>
<td class="cl-87055ebb"><p class="cl-87054344"><span class="cl-8702d85c">0.684</span></p></td>
<td class="cl-87055ec4"><p class="cl-87054344"><span class="cl-8702d85c">0.653</span></p></td>
<td class="cl-87055ec5"><p class="cl-87054344"><span class="cl-8702d85c">0.687</span></p></td>
<td class="cl-87055ece"><p class="cl-87054344"><span class="cl-8702d85c">0.696</span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="section level3">
<h3 id="survival-as-a-function-of-time">Survival as a function of time<a class="anchor" aria-label="anchor" href="#survival-as-a-function-of-time"></a>
</h3>
<p>As mentioned the biggest advantage of TTE models is the ease with
which one can model time-varying survival and then compute the
cumulative survival probability (parametric models only).</p>
<p>This time we’ll simulate data with an increase in survival as nest
age increases. The survival probability for the first interval is 0.93
and the regression coefficent is 0.3.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#simulate data</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></span>
<span></span>
<span><span class="va">max.age</span><span class="op">=</span><span class="fl">25</span></span>
<span><span class="va">N</span><span class="op">=</span><span class="fl">40</span></span>
<span><span class="va">age.seq</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">23</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">mu.s</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">qlogis</a></span><span class="op">(</span><span class="fl">0.93</span><span class="op">)</span></span>
<span><span class="va">beta.age</span><span class="op">=</span><span class="fl">0.3</span></span>
<span><span class="va">S</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">mu.s</span><span class="op">+</span><span class="va">beta.age</span><span class="op">*</span><span class="va">age.seq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumprod</a></span><span class="op">(</span><span class="va">S</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">true.mat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>,nrow<span class="op">=</span><span class="va">N</span>,ncol<span class="op">=</span><span class="va">max.age</span><span class="op">)</span></span>
<span></span>
<span></span>
<span> <span class="va">true.mat</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span></span>
<span> </span>
<span> <span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">N</span><span class="op">)</span><span class="op">{</span></span>
<span>   <span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="va">max.age</span><span class="op">)</span><span class="op">{</span></span>
<span>     </span>
<span>     <span class="va">true.mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">true.mat</span><span class="op">[</span><span class="va">i</span>,<span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="va">S</span><span class="op">[</span><span class="va">t</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span>   <span class="op">}</span></span>
<span> <span class="op">}</span></span>
<span> </span>
<span><span class="va">p.mat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">N</span><span class="op">*</span><span class="va">max.age</span>,<span class="fl">1</span>,<span class="fl">0.35</span><span class="op">)</span>,nrow<span class="op">=</span><span class="va">N</span>,ncol<span class="op">=</span><span class="va">max.age</span><span class="op">)</span></span>
<span><span class="co"># matrix if nest is observed</span></span>
<span></span>
<span><span class="co">#p.mat[,1]&lt;-1 # ensure all individuals observed at time=1</span></span>
<span></span>
<span><span class="va">p.mat</span><span class="op">[</span>,<span class="va">max.age</span><span class="op">]</span><span class="op">&lt;-</span><span class="fl">1</span> <span class="co">#all individuals observed by the end (no right censoring)</span></span>
<span></span>
<span><span class="va">true.mat</span><span class="op">[</span><span class="va">true.mat</span><span class="op">==</span><span class="fl">0</span><span class="op">]</span><span class="op">&lt;-</span> <span class="op">-</span><span class="fl">1</span> <span class="co">#assign -1 to dead individuals for later processing ease</span></span>
<span></span>
<span><span class="va">obs.mat</span><span class="op">&lt;-</span><span class="va">true.mat</span><span class="op">*</span><span class="va">p.mat</span></span>
<span></span>
<span></span>
<span><span class="va">obs.mat</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html" class="external-link">rownames_to_column</a></span><span class="op">(</span>var<span class="op">=</span><span class="st">"nest.id"</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html" class="external-link">pivot_longer</a></span><span class="op">(</span>cols<span class="op">=</span><span class="fl">2</span><span class="op">:</span><span class="op">(</span><span class="va">max.age</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>               names_to<span class="op">=</span><span class="st">'time'</span>,</span>
<span>               values_to<span class="op">=</span><span class="st">'obs'</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>time<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_remove.html" class="external-link">str_remove</a></span><span class="op">(</span><span class="va">time</span>,<span class="st">'V'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">obs</span><span class="op">!=</span><span class="fl">0</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">nest.id</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">obs</span><span class="op">&lt;</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>exposure<span class="op">=</span><span class="va">time</span><span class="op">-</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>         flag<span class="op">=</span><span class="va">obs</span><span class="op">*</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lag</a></span><span class="op">(</span><span class="va">obs</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">(</span><span class="va">obs</span><span class="op">==</span><span class="fl">1</span> <span class="op">|</span><span class="op">(</span><span class="va">obs</span><span class="op">==</span><span class="op">-</span><span class="fl">1</span> <span class="op">&amp;</span> <span class="va">flag</span><span class="op">==</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">flag</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">obs</span><span class="op">==</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">eh.long</span></span>
<span>  </span>
<span><span class="va">eh.long</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">nest.id</span>,<span class="va">time</span>,<span class="va">y</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">nest.id</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">y</span><span class="op">==</span><span class="fl">0</span><span class="op">|</span></span>
<span>         <span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">time</span><span class="op">[</span><span class="va">y</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">|</span></span>
<span>          <span class="va">time</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">time</span><span class="op">[</span><span class="va">y</span><span class="op">==</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>right<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">time</span><span class="op">)</span>,</span>
<span>         censor<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html" class="external-link">lead</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">right</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">nest.id</span>,left<span class="op">=</span><span class="va">time</span>,<span class="va">right</span>,<span class="va">censor</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">tte.time.dat</span></span>
<span></span>
<span></span>
<span><span class="va">eh.long</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">glm.time.dat</span></span></code></pre></div>
<div class="section level4">
<h4 id="time-varying-hazards-model">Time-varying hazards model<a class="anchor" aria-label="anchor" href="#time-varying-hazards-model"></a>
</h4>
<p>To fit the time-varying hazards model, we fit the exponential model
as above, and include a term to account for time. The method below just
includes nest age as a covariate, but an alternative is to use a
(improper) conditional autoregressive model. The iCAR model doesn’t try
to specify any kind of functional relationship (like a linear model),
but it can be more challenging to fit.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-nimble.org" class="external-link">nimble</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">time.model</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimbleCode.html" class="external-link">nimbleCode</a></span><span class="op">(</span><span class="op">{</span></span>
<span> <span class="va">gamma0</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/flat.html" class="external-link">dflat</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="va">beta</span><span class="op">~</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/flat.html" class="external-link">dflat</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  </span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">age</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="va">beta</span><span class="op">*</span><span class="va">nest.age</span><span class="op">[</span><span class="va">i</span><span class="op">]</span></span>
<span><span class="op">}</span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">records</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="kw">for</span> <span class="op">(</span><span class="va">k</span> <span class="kw">in</span> <span class="va">left</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">:</span><span class="op">(</span><span class="va">right</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>      </span>
<span>      <span class="va">UCH</span><span class="op">[</span><span class="va">j</span>,<span class="va">k</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">gamma0</span><span class="op">+</span><span class="va">age</span><span class="op">[</span><span class="va">k</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">S</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">UCH</span><span class="op">[</span><span class="va">j</span>,<span class="va">left</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">:</span><span class="op">(</span><span class="va">right</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">censored</span><span class="op">[</span><span class="va">j</span><span class="op">]</span> <span class="op">~</span> <span class="fu">dbern</span><span class="op">(</span><span class="va">S</span><span class="op">[</span><span class="va">j</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span></span>
<span>  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">24</span><span class="op">)</span> <span class="op">{</span> <span class="co">#compute the survival function S0</span></span>
<span>    <span class="va">UCH0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">gamma0</span><span class="op">+</span><span class="va">age</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">CH0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">UCH0</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co">#sum the unit cumulative hazard to get the cumulative</span></span>
<span>                 <span class="co">#hazard (i.e prob of surviving day 1 to i, or S^2,S^3..S^i</span></span>
<span>    <span class="va">S0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">CH0</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span> <span class="co"># transform to survival estimate to time i</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co">#define data and constants</span></span>
<span></span>
<span><span class="va">nim.const</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>records<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">tte.time.dat</span><span class="op">)</span>,</span>
<span>                left<span class="op">=</span><span class="va">tte.time.dat</span><span class="op">$</span><span class="va">left</span>,</span>
<span>                right<span class="op">=</span><span class="va">tte.time.dat</span><span class="op">$</span><span class="va">right</span>,</span>
<span>                nest.age<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">23</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nim.dat</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>censored<span class="op">=</span><span class="va">tte.time.dat</span><span class="op">$</span><span class="va">censor</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#inits</span></span>
<span></span>
<span><span class="va">nim.init</span><span class="op">&lt;-</span><span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  gamma0<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span>,</span>
<span>  beta<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span>,<span class="op">-</span><span class="fl">10</span>,<span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span>  <span class="co">#S=runif(nrow(tte.time.dat),0.5,0.9),</span></span>
<span>  <span class="co">#UCH=matrix(runif(nrow(tte.time.dat)*25,5,10),nrow=nim.const$records,ncol=25)</span></span>
<span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="va">time.nimmod</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/nimbleModel.html" class="external-link">nimbleModel</a></span><span class="op">(</span>code<span class="op">=</span><span class="va">time.model</span>,</span>
<span>                               constants<span class="op">=</span><span class="va">nim.const</span>,</span>
<span>                               data<span class="op">=</span><span class="va">nim.dat</span>,</span>
<span>                               inits<span class="op">=</span><span class="fu">nim.init</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time.nimmod</span><span class="op">$</span><span class="fu">calculate</span><span class="op">(</span><span class="op">)</span>  <span class="co"># Check to make sure initial values are good.</span></span>
<span>                              <span class="co">#Should be a real number</span></span>
<span><span class="va">time.nimmod</span><span class="op">$</span><span class="fu">initializeInfo</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time.config</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/configureMCMC.html" class="external-link">configureMCMC</a></span><span class="op">(</span><span class="va">time.nimmod</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># now is when you can specify different samplers and monitors</span></span>
<span><span class="va">time.config</span><span class="op">$</span><span class="fu">addMonitors</span><span class="op">(</span><span class="st">"CH0"</span>,<span class="st">"UCH0"</span>,<span class="st">"S0"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time.config</span><span class="op">$</span><span class="fu">replaceSamplers</span><span class="op">(</span>target <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'gamma0'</span>,<span class="st">'beta'</span><span class="op">)</span>,</span>
<span>                       type<span class="op">=</span> <span class="st">'AF_slice'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time.build</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/buildMCMC.html" class="external-link">buildMCMC</a></span><span class="op">(</span><span class="va">time.config</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co">#compile things</span></span>
<span></span>
<span><span class="va">time.comp</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/compileNimble.html" class="external-link">compileNimble</a></span><span class="op">(</span><span class="va">time.nimmod</span><span class="op">)</span></span>
<span></span>
<span><span class="va">time.mcmc</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/compileNimble.html" class="external-link">compileNimble</a></span><span class="op">(</span><span class="va">time.build</span>, project<span class="op">=</span><span class="va">time.comp</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">samples.time</span><span class="op">&lt;-</span><span class="fu">nimble</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/nimble/man/runMCMC.html" class="external-link">runMCMC</a></span><span class="op">(</span><span class="va">time.mcmc</span>,</span>
<span>                             niter<span class="op">=</span><span class="fl">10000</span>,</span>
<span>                             nburnin <span class="op">=</span> <span class="fl">3000</span>,</span>
<span>                             nchains <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></code></pre></div>
<p><img src="TTE-Advanced_files/figure-html/unnamed-chunk-19-1.png" class="r-plt" width="700"><img src="TTE-Advanced_files/figure-html/unnamed-chunk-19-2.png" class="r-plt" width="700"></p>
<pre><code><span><span class="co">##        parm          med   dsr.med cumsurv.med</span></span>
<span><span class="co">## 1   UCH0[1] 0.0450048247 0.9549952   0.9549952</span></span>
<span><span class="co">## 2   UCH0[2] 0.0347043221 0.9652957   0.9202909</span></span>
<span><span class="co">## 3   UCH0[3] 0.0266844750 0.9733155   0.8936064</span></span>
<span><span class="co">## 23 UCH0[23] 0.0001762815 0.9998237   0.8031316</span></span>
<span><span class="co">## 24 UCH0[24] 0.0001372484 0.9998628   0.8029943</span></span>
<span><span class="co">## 25 UCH0[25] 0.0001070775 0.9998929   0.8028873</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="analysis-using-logistic-exposure-1">Analysis using logistic exposure<a class="anchor" aria-label="anchor" href="#analysis-using-logistic-exposure-1"></a>
</h4>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">###########</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">mod.logexp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">time</span>,</span>
<span>                family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span></span>
<span>                  link<span class="op">=</span><span class="fu">MDChelp</span><span class="fu">::</span><span class="fu"><a href="../reference/logexp.html">logexp</a></span><span class="op">(</span><span class="va">glm.time.dat</span><span class="op">$</span><span class="va">exposure</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                data<span class="op">=</span><span class="va">glm.time.dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">broom</span><span class="fu">::</span><span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">mod.logexp</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">parms.logit</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># parms.logit</span></span>
<span></span>
<span></span>
<span><span class="co">#DSR</span></span>
<span><span class="va">parms.logit</span><span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">-&gt;</span><span class="va">dsr.logit</span></span>
<span><span class="co"># round(dsr.logit,digits=3)</span></span>
<span></span>
<span><span class="va">age</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">24</span>,<span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dsr.logexp</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">dsr.logit</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">dsr.logit</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">age</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="co"># dsr.logexp</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="analysis-using-the-cloglog-link-and-exposure-time-as-an-offset--1">Analysis using the cloglog link and exposure time as an offset.<a class="anchor" aria-label="anchor" href="#analysis-using-the-cloglog-link-and-exposure-time-as-an-offset--1"></a>
</h4>
<p>It turns out that this isn’t advisable when the exposure isn’t
roughly the same. It gives more biased estimates. I think part of the
issue to, arises from the shape of the cloglog distribution near the
tails of probability. If you want hazards, just run a hazards model.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">glm.time.dat</span><span class="op">$</span><span class="va">exposure</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="va">mod.clog</span><span class="op">&lt;-</span><span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu">glmmTMB</span><span class="op">(</span><span class="va">y</span><span class="op">~</span><span class="va">time</span><span class="op">+</span><span class="va">exposure</span>,</span>
<span>              family<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/family.html" class="external-link">binomial</a></span><span class="op">(</span>link<span class="op">=</span><span class="st">'cloglog'</span><span class="op">)</span>,</span>
<span>              data<span class="op">=</span><span class="va">glm.time.dat</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">glmmTMB</span><span class="fu">::</span><span class="fu">fixef</span><span class="op">(</span><span class="va">mod.clog</span><span class="op">)</span><span class="op">$</span><span class="va">cond</span><span class="op">-&gt;</span><span class="va">parms.clog</span></span>
<span></span>
<span><span class="va">parms.clog</span></span>
<span></span>
<span><span class="va">age</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">24</span>,<span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">glm.time.dat</span><span class="op">$</span><span class="va">exposure</span><span class="op">)</span></span>
<span><span class="co">#offset not included because log(1) (1 exposure day) = 0</span></span>
<span></span>
<span><span class="va">lp</span><span class="op">=</span> <span class="va">parms.clog</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">+</span><span class="va">parms.clog</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">*</span><span class="va">age</span> <span class="co"># linear predicator</span></span>
<span></span>
<span><span class="va">dsr.clog</span><span class="op">=</span><span class="fl">1</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lp</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dsr.clog</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="va">dsr.clog</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="state-space-or-hmm-formulation">State-space or HMM formulation<a class="anchor" aria-label="anchor" href="#state-space-or-hmm-formulation"></a>
</h4>
<p>The last step is going to be the equivalent of what Program MARK
does. It’s Bayesian so I don’t have to reformat data or anything like
that because if you haven’t figured out by now, I’m kind of lazy.</p>
<p><img src="TTE-Advanced_files/figure-html/unnamed-chunk-23-1.png" class="r-plt" width="700"></p>
<pre><code><span><span class="co">##  [1] 0.9621578 0.9684107 0.9736588 0.9780547 0.9817307 0.9848006 0.9873613</span></span>
<span><span class="co">##  [8] 0.9894951 0.9912719 0.9927504 0.9939799 0.9950020 0.9958512 0.9965567</span></span>
<span><span class="co">## [15] 0.9971425 0.9976289 0.9980327 0.9983678 0.9986459 0.9988767 0.9990682</span></span>
<span><span class="co">## [22] 0.9992271 0.9993589 0.9994682</span></span></code></pre>
<pre><code><span><span class="co">## [1] 0.7981269</span></span></code></pre>
<div class="tabwid">
<style>.cl-88ee96a6{}.cl-88e810ba{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88e810c4{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88eab84c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-88ead3d6{width:1.626in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3e0{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3e1{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3ea{width:1.626in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3eb{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3f4{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3f5{width:1.626in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3f6{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3fe{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead3ff{width:1.626in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead400{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead408{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead409{width:1.626in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead412{width:0.82in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88ead413{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88e211a6{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88e211b0{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style>
<table data-quarto-disable-processing="true" class="table cl-88ee96a6">
<caption style="display:table-caption;margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;">
<span class="cl-88e211a6">Table 4.</span><span class="cl-88e211b0"> Daily survival estimate comparison among methods, (time-varying survival).</span>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-88ead3d6"><p class="cl-88eab84c"><span class="cl-88e810ba">Model</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 1</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 2</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 3</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 4</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 5</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 6</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 7</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 8</span></p></th>
<th class="cl-88ead3e0"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 9</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 10</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 11</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 12</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 13</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 14</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 15</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 16</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 17</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 18</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 19</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 20</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 21</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 22</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 23</span></p></th>
<th class="cl-88ead3e1"><p class="cl-88eab84c"><span class="cl-88e810ba">Age 24</span></p></th>
</tr></thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-88ead3ea"><p class="cl-88eab84c"><span class="cl-88e810c4">Hazard</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9550</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9203</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8936</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8732</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8575</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8454</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8361</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8287</span></p></td>
<td class="cl-88ead3eb"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8230</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8185</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8150</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8122</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8101</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8084</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8071</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8061</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8053</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8047</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8042</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8038</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8035</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8033</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8031</span></p></td>
<td class="cl-88ead3f4"><p class="cl-88eab84c"><span class="cl-88e810c4">0.8030</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-88ead3f5"><p class="cl-88eab84c"><span class="cl-88e810c4">Logistic exposure</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9365</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9474</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9565</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9641</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9705</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9757</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9800</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9836</span></p></td>
<td class="cl-88ead3f6"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9865</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9889</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9909</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9926</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9939</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9950</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9959</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9966</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9972</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9977</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9982</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9985</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9988</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9990</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9992</span></p></td>
<td class="cl-88ead3fe"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9993</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-88ead3ff"><p class="cl-88eab84c"><span class="cl-88e810c4">State Space</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9622</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9684</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9737</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9781</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9817</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9848</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9874</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9895</span></p></td>
<td class="cl-88ead400"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9913</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9928</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9940</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9950</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9959</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9966</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9971</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9976</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9980</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9984</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9986</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9989</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9991</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9992</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9994</span></p></td>
<td class="cl-88ead408"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9995</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-88ead409"><p class="cl-88eab84c"><span class="cl-88e810c4">"Truth"</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9300</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9472</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9603</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9703</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9778</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9835</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9877</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9909</span></p></td>
<td class="cl-88ead412"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9932</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9950</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9963</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9972</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9979</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9985</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9989</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9992</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9994</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9995</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9997</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9997</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9998</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9999</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9999</span></p></td>
<td class="cl-88ead413"><p class="cl-88eab84c"><span class="cl-88e810c4">0.9999</span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="tabwid">
<style>.cl-890729d2{}.cl-89019238{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-89019242{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-8903ef4c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-89040856{width:1.224in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89040860{width:0.893in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8904086a{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8904086b{width:1.318in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8904086c{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89040874{width:1.224in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89040875{width:0.893in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8904087e{width:1.804in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-8904087f{width:1.318in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-89040888{width:0.914in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-88fdbbf4{font-family:'DejaVu Sans';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-88fdbc08{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}</style>
<table data-quarto-disable-processing="true" class="table cl-890729d2">
<caption style="display:table-caption;margin:0pt;text-align:left;border-bottom: 0.00pt solid transparent;border-top: 0.00pt solid transparent;border-left: 0.00pt solid transparent;border-right: 0.00pt solid transparent;padding-top:3pt;padding-bottom:3pt;padding-left:3pt;padding-right:3pt;line-height: 1;background-color:transparent;">
<span class="cl-88fdbbf4">Table 5.</span><span class="cl-88fdbc08"> Cumulative survival estimate comparison among methods; (time-varying survival).</span>
</caption>
<thead><tr style="overflow-wrap:break-word;">
<th class="cl-89040856"><p class="cl-8903ef4c"><span class="cl-89019238">Parameter</span></p></th>
<th class="cl-89040860"><p class="cl-8903ef4c"><span class="cl-89019238">Hazard</span></p></th>
<th class="cl-8904086a"><p class="cl-8903ef4c"><span class="cl-89019238">Logistic exposure</span></p></th>
<th class="cl-8904086b"><p class="cl-8903ef4c"><span class="cl-89019238">State Space</span></p></th>
<th class="cl-8904086c"><p class="cl-8903ef4c"><span class="cl-89019238">"Truth"</span></p></th>
</tr></thead>
<tbody><tr style="overflow-wrap:break-word;">
<td class="cl-89040874"><p class="cl-8903ef4c"><span class="cl-89019242">25d survival</span></p></td>
<td class="cl-89040875"><p class="cl-8903ef4c"><span class="cl-89019242">0.803</span></p></td>
<td class="cl-8904087e"><p class="cl-8903ef4c"><span class="cl-89019242">0.695</span></p></td>
<td class="cl-8904087f"><p class="cl-8903ef4c"><span class="cl-89019242">0.798</span></p></td>
<td class="cl-89040888"><p class="cl-8903ef4c"><span class="cl-89019242">0.753</span></p></td>
</tr></tbody>
</table>
</div>
<p>Now the fun part. The differences in the daily survival rates among
different methods, compared to “Truth” (<strong>Table 4.</strong>)
doesn’t seem too bad, and it’s likely due in part, to just random
sampling error (this is just one realization of truth). But I would
point out that the rate of change is different among the three different
methods, due to their underlying distributions (exponential-hazard,
modified logistic-logistic exposure, logistic-state space). This leads
to some non-trivial differences in the estimates of the cumulative
survival probability (<strong>Table 5.</strong>). This is a feature, not
a flaw. Even going back to Shaffer 2004<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;&lt;/p&gt;"><sup>6</sup></a>, the daily survival
estimates produced by the logistic exposure method and Program MARK are
different and would lead to substantially different cumulative survival
probabilities. In the example provided, the discrepancy among methods is
probably also a function of the baseline survival probability and how
quickly it increased. It might not be that bad if, in this case, DSR
never got close to 1, increased more slowly, started lower, or the
cumulative survival period was shorter.</p>
<p>So what to do? If I expected to model time-varying survival, I would
probably use the hazard or a state-space formulation. It might seem that
it’s because they seem to be the most in agreement, but it’s not. In the
logistic-exposure framework, covariates are assumed to be constant
across the exposure period. This is clearly not realistic if we are
talking about a nest age, or other time-varying covariates we can
measure even if we do not know the nest fate on the corresponding days
(daily temperature, daily rainfall, etc.) These other methods however
can, and I think that probably makes them a little better, across a wide
range of conditions/ parameter values. That said, all models are going
to be wrong, but they all are useful so do whatever works best in your
situation.</p>
</div>
</div>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tim Lyons.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
